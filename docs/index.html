<!DOCTYPE html>
<html dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>בוט לניהול סיכוני אסדרת חדשנות חינוכית</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      direction: rtl;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1, h2, h3 {
      color: #0056b3;
    }
    
    .form-section {
      background-color: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    
    input[type="text"], textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }
    
    textarea {
      min-height: 150px;
    }
    
    button {
      background-color: #0056b3;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
    }
    
    button:hover {
      background-color: #003d82;
    }
    
    .result-section {
      margin-top: 30px;
    }
    
    .risk-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    
    .risk-table th, .risk-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: right;
    }
    
    .risk-table th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
    
    .risk-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    .risk-table tr:hover {
      background-color: #eaeaea;
    }
    
    .high-severity {
      background-color: #ffcccc !important;
    }
    
    .medium-severity {
      background-color: #fff2cc !important;
    }
    
    .export-buttons {
      margin-top: 20px;
    }
    
    .export-buttons button {
      margin-left: 10px;
    }
    
    @media print {
      button, .form-section {
        display: none;
      }
      
      body, .container {
        width: 100%;
        margin: 0;
        padding: 0;
      }
      
      h1 {
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>בוט לניהול סיכוני אסדרת חדשנות חינוכית</h1>
    
    <div class="form-section">
      <h2>הזנת פרטי הפרויקט</h2>
      
      <div class="form-group">
        <label for="project-name">שם הפרויקט:</label>
        <input type="text" id="project-name" placeholder="הכנס את שם הפרויקט">
      </div>
      
      <div class="form-group">
        <label for="project-description">תיאור הפרויקט:</label>
        <textarea id="project-description" placeholder="תאר את הפרויקט בפירוט, כולל מאפייניו העיקריים"></textarea>
      </div>
      
      <h3>תרחיש עתידי רצוי:</h3>
      
      <div class="form-group">
        <label for="curriculum">תוכנית לימודים:</label>
        <textarea id="curriculum" placeholder="תאר את תוכנית הלימודים המוצעת בפרויקט"></textarea>
      </div>
      
      <div class="form-group">
        <label for="lte">למידה, הוראה והערכה:</label>
        <textarea id="lte" placeholder="תאר את תהליכי הלמידה, ההוראה וההערכה בפרויקט"></textarea>
      </div>
      
      <div class="form-group">
        <label for="infrastructure">תשתיות פיזיות וטכנולוגיות:</label>
        <textarea id="infrastructure" placeholder="תאר את התשתיות הפיזיות והטכנולוגיות הנדרשות בפרויקט"></textarea>
      </div>
      
      <div class="form-group">
        <label for="planning">תכנון וארגון:</label>
        <textarea id="planning" placeholder="תאר את מבנה הארגון והתכנון בפרויקט"></textarea>
      </div>
      
      <div class="form-group">
        <label for="stakeholders">בעלי עניין ושותפויות:</label>
        <textarea id="stakeholders" placeholder="פרט את בעלי העניין והשותפויות הנדרשות בפרויקט"></textarea>
      </div>
      
      <button id="analyze-button">נתח סיכונים</button>
    </div>
    
    <div class="result-section" id="result-section" style="display: none;">
      <h2>תוצאות ניתוח סיכונים</h2>
      
      <div id="risks-table-container"></div>
      
      <div class="export-buttons">
        <button id="export-csv">ייצוא ל-CSV</button>
        <button id="export-json">ייצוא ל-JSON</button>
        <button id="print-table">הדפסה</button>
      </div>
    </div>
  </div>

  <script>
    // מרכיב ניהול סיכונים בבוט
    class RiskManagementTable {
      constructor() {
        // מבנה טבלת הסיכונים המוגדרת מראש
        this.riskCategories = [
          { id: 1, name: "תוכן, תכנים", description: "היווצרות גדולה יותר של תכנים מבוססי ב\"מ", impacts: "הצורך למנגנוני בקרה לאיכות, השטחה של התוצר" },
          { id: 2, name: "כשירות צוות בב\"מ", description: "עלייה בדרישה לכשירות", impacts: "הכשרה של צוותים, צורך למודעות להשלכות אתיות" },
          { id: 3, name: "מקצוענות", description: "אובדן ידע ומקצוענות", impacts: "ירידה באמון באנשי מקצוע, בריחת אנשי מקצוע לתחומים אחרים" },
          { id: 4, name: "ארגון ותכנון", description: "שיבוש של תיאורי תפקידים", impacts: "החלשות מקום הדיאלוג הבין צוותי, ״אדם מול מכונה״ במקום ״אדם מול אדם״" },
          { id: 5, name: "תשתיות", description: "תלות בתשתיות תקשוב חזקות", impacts: "צורך לתקצוב רכישה ותחזוקה, תלות יתר בטכנולוגיה" },
          { id: 6, name: "פרקטיקות הוראה", description: "שיבושים בדרכי הוראה", impacts: "היווצרות גדולה יותר של פרקטיקות, צורך במנגנוני בקרה לאיכות, צורך מיידי להכשרה מקצועית" },
          { id: 7, name: "הערכה של עבודת הצוות", description: "עדכון תהליך הערכה צוותי", impacts: "שינוי בדרישות הערכה ומדידה" },
          { id: 8, name: "חיבוריות", description: "פיצול בין הנלמד במחקר לבין עקרונות יישום", impacts: "קושי ביישום ממצאי מחקר בשדה" }
        ];
        
        // ערכי ברירת מחדל לניקוד סיכונים כפי שהופיעו בטבלה
        this.defaultRiskScores = [
          { categoryId: 1, probability: 6, impact: 4, severity: 24 },
          { categoryId: 2, probability: 7, impact: 3, severity: 21 },
          { categoryId: 3, probability: 3, impact: 6, severity: 18 },
          { categoryId: 4, probability: 2, impact: 4, severity: 8 },
          { categoryId: 5, probability: 3, impact: 2, severity: 6 },
          { categoryId: 6, probability: 2, impact: 3, severity: 6 },
          { categoryId: 7, probability: 2, impact: 3, severity: 6 },
          { categoryId: 8, probability: 1, impact: 2, severity: 2 }
        ];
        
        this.projectRisks = [];
      }
      
      // ניתוח סיכונים עבור פרויקט ספציפי
      analyzeProjectRisks(projectDescription) {
        // מכאן הבוט ינתח את הפרויקט ויערוך התאמה של דירוגי הסיכון
        this.projectRisks = this.riskCategories.map((category, index) => {
          // בשלב זה נשתמש בערכי ברירת מחדל, בהמשך יוחלף באלגוריתם חכם יותר
          const defaultScore = this.defaultRiskScores.find(score => score.categoryId === category.id);
          
          // כאן יוטמע אלגוריתם שמתאים את הדירוג לפרויקט הספציפי
          const projectRelevance = this.calculateProjectRelevance(category, projectDescription);
          
          // התאמת דירוג הסיכון לפי רלוונטיות לפרויקט
          const probability = this.adjustScore(defaultScore.probability, projectRelevance);
          const impact = this.adjustScore(defaultScore.impact, projectRelevance);
          const severity = probability * impact;
          
          return {
            id: category.id,
            category: category.name,
            description: category.description,
            impacts: category.impacts,
            probability: probability,
            impact: impact,
            severity: severity,
            mitigationStrategies: this.generateMitigationStrategies(category, severity)
          };
        });
        
        // מיון הסיכונים לפי חומרה יורדת
        this.projectRisks.sort((a, b) => b.severity - a.severity);
        
        return this.projectRisks;
      }
      
      // חישוב רלוונטיות הסיכון לפרויקט ספציפי
      calculateProjectRelevance(riskCategory, projectDescription) {
        // כאן יוטמע אלגוריתם שמחפש מילות מפתח וקשרים בין תיאור הפרויקט לקטגוריית הסיכון
        // לדוגמה בלבד:
        const relevanceKeywords = {
          "תוכן, תכנים": ["תוכן", "תכנים", "למידה", "מידע", "ידע", "ב\"מ"],
          "כשירות צוות בב\"מ": ["צוות", "הכשרה", "מורים", "כשירות", "מיומנות", "ב\"מ"],
          "מקצוענות": ["מקצועיות", "מומחיות", "ידע", "ניסיון", "מיומנות"],
          "ארגון ותכנון": ["ארגון", "תכנון", "מבנה", "תפקידים", "ניהול"],
          "תשתיות": ["תשתית", "טכנולוגיה", "ציוד", "מחשבים", "רשת", "תקשוב"],
          "פרקטיקות הוראה": ["הוראה", "פדגוגיה", "למידה", "שיטות", "דרכים"],
          "הערכה של עבודת הצוות": ["הערכה", "מדידה", "ביצועים", "צוות"],
          "חיבוריות": ["חיבור", "קשר", "שיתוף פעולה", "אינטגרציה", "מחקר", "יישום"]
        };
        
        const categoryKeywords = relevanceKeywords[riskCategory.name] || [];
        let relevanceScore = 0;
        
        // חיפוש מילות מפתח בתיאור הפרויקט
        categoryKeywords.forEach(keyword => {
          if (projectDescription.includes(keyword)) {
            relevanceScore += 0.2; // תוספת לציון הרלוונטיות עבור כל מילת מפתח שנמצאה
          }
        });
        
        // ערך בין 0.5 ל-1.5, כאשר 1 מייצג רלוונטיות ניטרלית
        return Math.max(0.5, Math.min(1.5, 1 + relevanceScore));
      }
      
      // התאמת דירוג בהתאם לרלוונטיות לפרויקט
      adjustScore(defaultScore, relevanceFactor) {
        // התאמת הציון בהתבסס על רלוונטיות, עם שמירה על טווח 1-10
        const adjustedScore = Math.round(defaultScore * relevanceFactor);
        return Math.max(1, Math.min(10, adjustedScore));
      }
      
      // יצירת אסטרטגיות להתמודדות עם הסיכון
      generateMitigationStrategies(riskCategory, severity) {
        // מאגר אסטרטגיות מיטיגציה לפי קטגוריה וחומרה
        const strategies = {
          "תוכן, תכנים": [
            { minSeverity: 20, strategy: "פיתוח מנגנוני בקרת איכות מובנים ומוסדרים לתכנים מבוססי ב\"מ" },
            { minSeverity: 10, strategy: "הגדרת סטנדרטים ברורים לאיכות התוצרים הנדרשת" },
            { minSeverity: 1, strategy: "ביקורת עמיתים על תכנים לפני אישורם לשימוש" }
          ],
          "כשירות צוות בב\"מ": [
            { minSeverity: 20, strategy: "פיתוח תוכנית הכשרה מקיפה ומחייבת לכל אנשי הצוות" },
            { minSeverity: 10, strategy: "הקצאת שעות ייעודיות ללמידה והתנסות בכלי ב\"מ" },
            { minSeverity: 1, strategy: "יצירת קהילת למידה מקצועית בנושא שימוש מושכל בב\"מ" }
          ],
          "מקצוענות": [
            { minSeverity: 15, strategy: "שילוב מומחיות אנושית כחלק מובנה ומחייב בכל תהליך המשלב ב\"מ" },
            { minSeverity: 8, strategy: "תיעוד ושימור ידע מקצועי באופן מסודר" },
            { minSeverity: 1, strategy: "הגדרת תחומים בהם שיקול דעת אנושי מקצועי הוא הכרחי" }
          ],
          "ארגון ותכנון": [
            { minSeverity: 8, strategy: "הגדרה מחדש של תפקידים ותחומי אחריות במערכת המשלבת ב\"מ" },
            { minSeverity: 5, strategy: "יצירת מנגנונים לחיזוק התקשורת והדיאלוג הבין-צוותי" },
            { minSeverity: 1, strategy: "פיתוח תרבות ארגונית המדגישה את הערך האנושי בחינוך" }
          ],
          "תשתיות": [
            { minSeverity: 6, strategy: "תכנון תקציבי רב-שנתי לרכישה ותחזוקת תשתיות" },
            { minSeverity: 3, strategy: "פיתוח מענים חלופיים למקרה של תקלות טכנולוגיות" },
            { minSeverity: 1, strategy: "הגדרת סטנדרטים מינימליים לתשתיות הנדרשות" }
          ],
          "פרקטיקות הוראה": [
            { minSeverity: 6, strategy: "פיתוח מאגר פרקטיקות הוראה מומלצות המשלבות ב\"מ" },
            { minSeverity: 3, strategy: "תהליכי ניסוי והערכה מבוקרים לפרקטיקות חדשות" },
            { minSeverity: 1, strategy: "שיתוף וחניכה של מורים בפרקטיקות מוצלחות" }
          ],
          "הערכה של עבודת הצוות": [
            { minSeverity: 5, strategy: "פיתוח מדדים חדשים להערכת הצוות בסביבה משולבת ב\"מ" },
            { minSeverity: 3, strategy: "הכשרת מנהלים בהערכת עבודה בסביבה משולבת טכנולוגיה" },
            { minSeverity: 1, strategy: "שילוב משוב עמיתים כחלק מתהליכי הערכה" }
          ],
          "חיבוריות": [
            { minSeverity: 2, strategy: "יצירת פורומים משותפים לאנשי מחקר ושדה" },
            { minSeverity: 1, strategy: "הנגשת ממצאי מחקר לאנשי השדה ואיסוף משוב" }
          ]
        };
        
        // בחירת אסטרטגיות מתאימות לפי רמת חומרה
        const categoryStrategies = strategies[riskCategory.name] || [];
        const relevantStrategies = categoryStrategies
          .filter(s => s.minSeverity <= severity)
          .map(s => s.strategy);
        
        return relevantStrategies;
      }
      
      // יצירת טבלת סיכונים בפורמט HTML
      generateRiskTableHTML() {
        let tableHTML = `
          <table class="risk-table">
            <thead>
              <tr>
                <th>מס'</th>
                <th>קטגוריה</th>
                <th>תיאור הסיכון</th>
                <th>השלכות הסיכון</th>
                <th>הסתברות (1-10)</th>
                <th>נזק צפוי (1-10)</th>
                <th>חומרת הסיכון</th>
                <th>אסטרטגיות להתמודדות</th>
              </tr>
            </thead>
            <tbody>
        `;
        
        this.projectRisks.forEach(risk => {
          tableHTML += `
            <tr>
              <td>${risk.id}</td>
              <td>${risk.category}</td>
              <td>${risk.description}</td>
              <td>${risk.impacts}</td>
              <td>${risk.probability}</td>
              <td>${risk.impact}</td>
              <td>${risk.severity}</td>
              <td>
                <ul>
                  ${risk.mitigationStrategies.map(strategy => `<li>${strategy}</li>`).join('')}
                </ul>
              </td>
            </tr>
          `;
        });
        
        tableHTML += `
            </tbody>
          </table>
        `;
        
        return tableHTML;
      }
      
      // יצירת טבלת סיכונים בפורמט CSV
      generateRiskTableCSV() {
        let csv = "מספר,קטגוריה,תיאור הסיכון,השלכות הסיכון,הסתברות,נזק צפוי,חומרת הסיכון,אסטרטגיות להתמודדות\n";
        
        this.projectRisks.forEach(risk => {
          csv += `${risk.id},"${risk.category}","${risk.description}","${risk.impacts}",${risk.probability},${risk.impact},${risk.severity},"${risk.mitigationStrategies.join('; ')}"\n`;
        });
        
        return csv;
      }
      
      // יצירת טבלת סיכונים בפורמט JSON
      generateRiskTableJSON() {
        return JSON.stringify(this.projectRisks, null, 2);
      }
    }

    class RiskAssessmentBot {
      constructor() {
        this.projectData = null;
        this.riskTable = new RiskManagementTable();
      }
      
      // קריאת מסמך הפרויקט
      readProjectDocument(projectData) {
        this.projectData = projectData;
        console.log("מסמך הפרויקט נקרא בהצלחה");
      }
      
      // זיהוי סיכונים
      identifyRisks() {
        console.log("זיהוי סיכונים פוטנציאליים בפרויקט");
      }
      
      // ניתוח סיכונים
      analyzeRisks() {
        console.log("ניתוח וכימות הסיכונים");
        
        // יצירת תיאור מלא של הפרויקט לצורך ניתוח
        const fullDescription = [
          this.projectData.description,
          this.projectData.curriculum,
          this.projectData.lte,
          this.projectData.infrastructure,
          this.projectData.planning,
          this.projectData.stakeholders
        ].join(' ');
        
        // ניתוח סיכונים ספציפיים לפרויקט
        this.riskTable.analyzeProjectRisks(fullDescription);
      }
      
      // הצלבה עם רגולציה קיימת
      matchWithExistingRegulations() {
        console.log("הצלבה עם רגולציה קיימת");
      }
      
      // הפקת דוח סיכונים
      generateRiskReport() {
        if (!this.projectData) {
          return { html: "יש להזין נתוני פרויקט תחילה" };
        }
        
        return {
          html: this.riskTable.generateRiskTableHTML(),
          csv: this.riskTable.generateRiskTableCSV(),
          json: this.riskTable.generateRiskTableJSON()
        };
      }
    }

    // קוד ראשי - מוכן לשימוש
    document.addEventListener('DOMContentLoaded', function() {
      // אירוע ללחיצה על כפתור ניתוח
      document.getElementById('analyze-button').addEventListener('click', function() {
        // איסוף נתוני הפרויקט מהטופס
        const projectData = {
          name: document.getElementById('project-name').value,
          description: document.getElementById('project-description').value,
          curriculum: document.getElementById('curriculum').value,
          lte: document.getElementById('lte').value,
          infrastructure: document.getElementById('infrastructure').value,
          planning: document.getElementById('planning').value,
          stakeholders: document.getElementById('stakeholders').value
        };
        
        // בדיקה שהוזנו נתונים מינימליים
        if (!projectData.name || !projectData.description) {
          alert('יש להזין לפחות שם פרויקט ותיאור כללי');
          return;
        }
        
        // יצירת מופע של הבוט
        const bot = new RiskAssessmentBot();
        
        // קריאת מסמך הפרויקט
        bot.readProjectDocument(projectData);
        
        // זיהוי סיכונים
        bot.identifyRisks();
        
        // ניתוח סיכונים
        bot.analyzeRisks();
        
        // הצלבה עם רגולציה קיימת
        bot.matchWithExistingRegulations();
        
        // הפקת דוח סיכונים
        const report = bot.generateRiskReport();
        
        // הצגת טבלת הסיכונים
        document.getElementById('risks-table-container').innerHTML = report.html;
        
        // הצגת אזור התוצאות
        document.getElementById('result-section').style.display = 'block';
        
        // הוספת צבעים לפי חומרת סיכון
        const rows = document.querySelectorAll('.risk-table tbody tr');
        rows.forEach(row => {
          const severityCell = row.cells[6];
          const severityValue = parseInt(severityCell.textContent);
          
          if (severityValue >= 15) {
            row.classList.add('high-severity');
          } else if (severityValue >= 8) {
            row.classList.add('medium-severity');
          }
        });
        
        // הגדרת פונקציות ייצוא
        document.getElementById('export-csv').addEventListener('click', function() {
          downloadFile(report.csv, 'risk-analysis.csv', 'text/csv');
        });
        
        document.getElementById('export-json').addEventListener('click', function() {
          downloadFile(report.json, 'risk-analysis.json', 'application/json');
        });
        
        document.getElementById('print-table').addEventListener('click', function() {
          window.print();
        });
      });
      
      // פונקציה להורדת קובץ
      function downloadFile(content, fileName, contentType) {
        const a = document.createElement("a");
        const file = new Blob([content], { type: contentType });
        a.href = URL.createObjectURL(file);
        a.download = fileName;
        a.click();
        URL.revokeObjectURL(a.href);
      }
    });
  </script>
</body>
</html>
